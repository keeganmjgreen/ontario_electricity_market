# Supply and Demand of Electricity

## Introduction to economics: Your friendly neighborhood espresso market

Imagine a neighborhood of cafés, all serving espresso. What a wondrous place to live! The baristas make as many espresso shots as customers buy. More specifically, at any given time, the rate at which baristas supply espresso shots (e.g., in shots per hour) is always equal to the rate at which customers demand them.

For reasons that will become apparent later, we will assume that all cafés serve identical espresso and offer an identical experience to customers. Because the cafés' offerings are the same and they are conveniently located within the same neighborhood, the only thing that would set them apart in the eyes of customers is their prices.

But if a café tries to undercut its neighbors, the other cafés will follow suit if the lower price is sustainable in order to stay competitive. And if a café raises its price to increase its profit margin, others will be able to do the same. For a given time, place, and offering, there is one stable price. Different cafés may have different operating costs&mdash;perhaps a café has a more expensive supplier of espresso beans&mdash;but they tend to charge the same price per espresso shot and pocket the difference.

Customers' demand for espresso shots is based on how much the cafés charge for each one; there will be fewer customers if the cafés charge more and vice-versa. Thus, the rate at which customers buy espresso is a function of the price per espresso shot. This function is called the demand curve, which models buyer behavior in aggregate and is generally monotonically decreasing. The demand curve changes with time; for example, demand for espresso is greatest in the morning.

If the cafés have to make more espresso, they will have to purchase more espresso beans. They will have to call upon additional baristas to help, or in general have to pay each barista more per hour&mdash;more per shot, essentially. In other words, the cafés have a cost per espresso shot, which is reflected in the price they charge for each one. However, the cafés' price per shot is not constant. If the cafés are overwhelmed with customers, they may charge more for each espresso shot to take advantage of the situation and make more profit per shot. The cafés may have to augment their baristas' hourly wages with bonus pay to keep them happy. In order to meet the demand, the cafés may also have to bust out their older, less efficient espresso machines from their back rooms that use more espresso beans per shot. On the other hand, if the cafés are having a slow day, they may reduce their price and sacrifice some profit per espresso shot in order to make the most of the low demand. This is called dynamic pricing. The price is a function of the rate at which espresso shots are being sold. This function is called the supply curve, which models seller behavior in aggregate and is generally monotonically increasing.

A given café is willing to sell espresso at or above a certain price, and a given customer is willing to buy at or below a certain price.

## The market clearing process

The above principles are true not just for a neighborhood of cafés but for any capitalist market. These basic tenets of economics are the principles of supply and demand. They apply wherever a quantity $Q$ of a particular good is exchanged at a price $P$. $Q$ is measured in goods per hour, and $P$ is measured in dollars (or any other currency) per good.

The allocation of buyers to sellers (customers to cafés) is a process called *clearing the market*. This determines the quantity of goods that gets exchanged in the market, $Q^*$, and at what price, $P^*$. This price is known as the *market price* or *market-clearing price*. Sellers who charge a low price are able to produce at a low cost and do not price-gouge. A capitalist market rewards such sellers, giving them priority over other, less efficient ones. At the same time, a capitalist market rewards buyers who are willing to pay a high price, giving them priority over other buyers who don't value the product as much. It follows that we can model the market clearing process by allocating an increasing quantity of goods to the buyers and sellers, starting with the buyers who are willing to pay the most and the sellers who are willing to charge the least, until the buying price equals the selling price.

We can represent this model graphically (or mathematically) by plotting the supply and demand curves as shown in [](#fig_2_1). The market-clearing price $P^*$ and quantity $Q^*$ are dictated by the point where the two curves intersect. The area under the supply curve until a quantity $Q$ represents the cost $C$ of selling that quantity, equal to the production cost plus the profit margin. The area under the demand curve until a quantity $Q$ represents the cumulative value delivered to buyers by that quantity, known in economics as *utility*, $U\!$. Subject to the constraint that the quantity sold must be the same as the quantity bought, $Q^*$ simultaneously maximizes buyer utility and minimizes seller cost. The difference $U - C$ is known as *welfare*, $W\!$, in economics. In clearing the market, welfare is maximized.

```{figure} img/fig_2_1.png
:label: fig_2_1
:width: 100%

Supply and demand curves.
```

Obviously there is no regulatory body that allocates customers to cafés, no economist planted in town square finding the intersection between the supply and demand curves. Your friendly neighborhood espresso market clears itself. Cafés try to charge the highest price that the optimal number of customers are willing to pay, and customers naturally seek out the lowest price that cafés are willing to charge; the two sides meet somewhere in the middle.

## The electricity market

The principles of supply and demand are so universal that they apply to the power grid when operated as an electricity market. In this case, the good is not espresso shots but megawatt-hours of electricity&mdash;energy for machines, rather than for humans. The unit of measurement is not espresso shots per hour but megawatt-hours per hour&mdash;so, just megawatts (MW). In an electricity market, the rate at which electricity is supplied (the production, or generation) is always equal to the rate at which it is demanded (the consumption, or load). In the café analogy, generators are espresso machines, and loads&mdash;such as your local utility company&mdash;are customers. Everything that we've discussed so far in terms of cafés (and capitalist markets in general) applies to the electricity market.

We assumed before that all cafés served identical espresso. In other words, we assumed that espresso is a *commodity*&mdash;a good that varies little between sellers and that buyers need not be picky about. Obviously this isn't true about espresso in the real world! Examples of commodities include wheat, crude oil, and...electricity! Indeed, all electrons are created equal. Electricity may be produced from a variety of energy sources (nuclear, hydro, and so on) and travel varying distances to get to your home, but there is no differentiating between a nuclear-generated electron and a hydro-generated electron. People care about the origin and locality of their food more than that of their electricity. Yes, some people care about the environmental sustainability of their electricity&mdash;I among them&mdash;but we cannot choose between sustainable and unsustainable electrons. We can only choose to consume electricity at times of day when there is a higher proportion of sustainable electrons in the mix. But, at a given time, all electrons are equal.

Previously we discussed the market clearing process. The electricity market must be cleared like any other, but unlike a neighborhood espresso market, it cannot feasibly clear itself. There are two reasons for this.

First of all, there is no buffer between production and consumption. If cafés are busy, customers can feasibly wait for up to several minutes between placing their orders and receiving their espresso. Alternately, the cafés can prepare extra espresso shots while morning demand is still ramping up, to reduce customer wait times. But this does not work in the electricity market. When you turn on your kettle, you don't have to wait even a second for power. You just take. The grid cannot ramp up in advance of everyone turning on their kettles in the morning because, traditionally, there is no way to store that extra power.

The second reason for which the electricity market cannot clear itself is that resources are pooled. When you want espresso, you go to one café and talk to one barista who fulfills your order. But when you want to turn on your electric kettle at home, you don't call up a generator and ask them to ramp up by a couple kilowatts. There is a disconnect between the demand (you, or rather, your utility company) and the supply (the generators).

Thus, the electricity market must be administered by a regulatory body&mdash;the ISO&mdash;that monitors the demand, and tells each generator how much to supply such that the total supply exactly equals the demand at all times. It is worth it to have an organization that is different to the company or companies who own and operate the generators, because it fosters healthy competition between the generation companies, which reduces the cost of electricity.

## Bids to buy and offers to sell power

Loads and generators submit bids to buy power and offers to sell power, respectively. Bids and offers are known in general as market submissions. Each submission includes a list of price-quantity pairs. In a given price-quantity pair, the quantity is the maximum quantity of power that a generator is willing to sell, or that a load is willing to buy, at the corresponding price in the pair. The price is measured in dollars per MWh, and the quantity is measured in MW. For an offer, the price must monotonically increase as the quantity increases, and for a bid, the price must monotonically decrease as the quantity increases.

If these sound similar to supply and demand curves, it's because they are! In an electricity market with one generator and one load, the generator's $(P_\mathrm{G}, Q_\mathrm{G})$ pairs would define the market's supply curve and the load's $(P_\mathrm{L}, Q_\mathrm{L})$ pairs would define the market's demand curve. The two curves' intersection determines the quantity $Q^*$ of power that will be delivered at the market-clearing price $P^*$, which maximizes $U - C$.

### Example 2.1: One generator, one load

Consider the example shown in {ref}`fig_2_2`. The generator says they are willing to produce up to 6 MW for \$2/MWh, or up to 9 MW for \$7/MWh. The load says they are willing to consume up to 4 MW for \$8/MWh, or up to 8 MW for \$5/MWh. The market clears at $Q^* = 6 \ \mathrm{MW}$ and $P^* = \$5/\mathrm{MWh}$.

```{figure} img/fig_2_2.png
:label: fig_2_2
:width: 100%

Supply and demand curves formed by the price-quantity pairs of the one generator and one load of Example 2.1.
```

### Example 2.2: Two generators, two loads

What if there are two generators, $\mathrm{G1}$ and $\mathrm{G2}$, and two loads, $\mathrm{L1}$ and $\mathrm{L2}$? Consider the example price-quantity pairs shown in {ref}`fig_2_3`.

```{figure} img/fig_2_3.png
:label: fig_2_3
:width: 100%

Price-quantity pairs of the two generators and two loads of Example 2.2.
```

In clearing the market, we still want to maximize $W = U - C$ subject to the constraint that the total quantity sold, $Q_\mathrm{G1} + Q_\mathrm{G2}$, must equal the total quantity bought, $Q_\mathrm{L1} + Q_\mathrm{L2}$. This constraint represents conservation of power flow.

$$
\begin{aligned}
& \! \max_{Q_\mathrm{G1}, \, Q_\mathrm{G2}, \, Q_\mathrm{L1}, \, Q_\mathrm{L2}} W(Q_\mathrm{G1}, Q_\mathrm{G2}, Q_\mathrm{L1}, Q_\mathrm{L2}) \\
& \text{subject to} \quad Q_\mathrm{G1} + Q_\mathrm{G2} = Q_\mathrm{L1} + Q_\mathrm{L2}
\end{aligned}
$$

Where the total seller cost is the total area under each generator's supply curve, up to the quantity produced by each generator:

$$
C(Q_\mathrm{G1}, Q_\mathrm{G2}) = \int_0^{\, Q_\mathrm{G1}} p_\mathrm{G1}(q) \, \mathrm{d} q + \int_0^{\, Q_\mathrm{G2}} p_\mathrm{G2}(q) \, \mathrm{d} q
$$

And the total buyer utility is the total area under each load's demand curve, up to the quantity consumed by each load:

$$
U(Q_\mathrm{L1}, Q_\mathrm{L2}) = \int_0^{\, Q_\mathrm{L1}} p_\mathrm{L1}(q) \, \mathrm{d} q + \int_0^{\, Q_\mathrm{L2}} p_\mathrm{L2}(q) \, \mathrm{d} q
$$

This optimization problem can be simplified by splicing the generators' and loads' price-quantity pairs into a unified supply curve and a unified demand curve, respectively. The optimization problem can then be solved by finding the intersection between the supply and demand curves. The solution to the example at hand is $Q^* = 11$, $P^* = 4$. This is shown in {ref}`fig_2_5`, and {ref}`fig_2_4` shows how $Q^*$ corresponds to the individual quantities $Q_\mathrm{G1}^*$, $Q_\mathrm{G2}^*$, $Q_\mathrm{L1}^*$, and $Q_\mathrm{L2}^*$. The optimal cost, utility, and welfare are tabulated in {ref}`tab_2_1`.

```{figure} img/fig_2_4.png
:label: fig_2_4
:width: 100%

Price-quantity pairs of the two generators and two loads of Example 2.2, showing their optimal costs and utility values, respectively.
```

```{figure} img/fig_2_5.png
:label: fig_2_5
:width: 100%

Supply and demand curves spliced together from the price-quantity pairs of the two generators and two loads of Example 2.2, respectively, showing the resulting market-clearing price and quantity.
```

```{table} Optimal cost, utility, and welfare of Example 2.2.
:label: tab_2_1

|        |                     Cost |                  Utility |  Welfare |
|-------:|-------------------------:|-------------------------:|---------:|
|        | $C_\mathrm{G1} = \$12.0$ | $C_\mathrm{L1} = \$52.0$ |          |
|        | $C_\mathrm{G2} = \$20.0$ | $C_\mathrm{L2} = \$27.0$ |          |
| Total: |                 $\$20.0$ |                 $\$79.0$ | $\$47.0$ |
```

## The market network

We have established that for a given market, at a given time, there is one market price. For the purposes of market modeling, the grid consists of multiple pricing nodes, each of which has its own market price and in that sense acts like a market. Each node is analogous to one neighborhood of cafés. But, of course, the grid is an electrical network, and power can be transferred between its nodes through long-distance transmission and distribution lines. This is as if the neighborhoods of cafés were interconnected by an intricate network of pipes! Like electricity, espresso wouldn't even have to be made in the neighborhood in which it is consumed. Supply need not equal demand within a grid node. Because quantities of power can be traded between grid nodes, the entire grid must be cleared as one market in order to maximize the system-wide welfare $W\!$. The total welfare is generally higher with trade than without, which is why trade takes place.

However, the network is leaky. Transmission and distribution lines are not ideal wires and have electrical resistance depending on their type and length. Thus, some power is lost to heat for each unit of power transferred. These transmission losses are analogous to a cost of trade between grid nodes. Power transfer between nodes is still usually necessary and beneficial. For example, it is likely be cheaper to use nuclear power transmitted over a great distance, with some lost along the way, than to use power from a nearby gas-fired plant. We need a way to model and account for the costs of trade when clearing the market, as they will affect the optimal quantities of power and cause prices to differ between nodes. In general, each node affects all other nodes.

A line's transmission losses can be modeled by the line's efficiency, $\eta$:

$$
\eta = \frac{\text{power out}}{\text{power in}} = \frac{\text{power out}}{\text{power out} + \text{power lost}}
$$

### Example 2.3: One generator node, one load node

Recall the previous section's example of two generators and two loads. Consider now that the generators $\mathrm{G1}$ and $\mathrm{G2}$ are located at a node $\mathrm{A}$, and that the two loads $\mathrm{L1}$ and $\mathrm{L2}$ are located at a node $\mathrm{B}$. The two nodes are connected by a transmission line with 75% efficiency. This is an unrealistically poor efficiency, for illustrative purposes. The optimization problem becomes maximizing $W\!$ subject to the constraint that the total quantity bought, $Q_\mathrm{L}$, must equal 75% of the total quantity sold, $Q_\mathrm{G}$, meaning that for every 1 MW generated, only 0.75 MW are delivered to the load, the rest being lost to heat. Of the two quantities $Q_\mathrm{G}$ and $Q_\mathrm{L}$, either can be chosen as the optimization problem's sole decision variable, from which the other quantity can be calculated via the efficiency. The solution to the example at hand is $Q_\mathrm{G}^* = 9.\bar{3} \ \mathrm{MW}$, $Q_\mathrm{L}^* = 7 \ \mathrm{MW}$, $P_\mathrm{G}^* = \$4/\mathrm{MWh}$, $P_\mathrm{L}^* = \$8/\mathrm{MWh}$. This is shown in {ref}`fig_2_6`. The optimal cost, utility, and welfare are tabulated in {ref}`tab_2_2`.

<!-- How to quantify cost of transmission? Delta p times delta q? -->
<!-- Who pays for losses? -->
<!-- Welfare evenly distributed? -->

```{figure} img/fig_2_6.png
:label: fig_2_6
:width: 100%

Determining the market-clearing prices and quantities for the two-node grid of Example 2.3.
```

```{table} Optimal cost, utility, and welfare of Example 2.3.
:label: tab_2_2

|        |                           Cost |                  Utility |        Welfare |
|-------:|-------------------------------:|-------------------------:|---------------:|
|        |       $C_\mathrm{G1} = \$12.0$ | $C_\mathrm{L1} = \$32.0$ |                |
|        | $C_\mathrm{G2} = \$13.\bar{3}$ | $C_\mathrm{L2} = \$27.0$ |                |
| Total: |                 $\$25.\bar{3}$ |                 $\$59.0$ | $\$33.\bar{6}$ |
```

### Example 2.4: One generator node, one combined generator/load node

Now consider that only generator $\mathrm{G1}$ is located at node $\mathrm{A}$, while generator $\mathrm{G2}$ and both loads are located at node $\mathrm{B}$. The optimization problem becomes maximizing $W\!$ subject to the constraint that $0.75 \, Q_\mathrm{G1} + Q_\mathrm{G2} = Q_\mathrm{L}$. Any two of these three quantities can be chosen as the decision variables; we will use $Q_\mathrm{G2}$ and $Q_\mathrm{L}$ arbitrarily. The optimization problem is then:

$$
\begin{aligned}
& \!\! \max_{Q_\mathrm{G2}, \, Q_\mathrm{L}} W(Q_\mathrm{G2}, Q_\mathrm{L}) \\
& \text{subject to} \quad 0.75 \, Q_\mathrm{G1} + Q_\mathrm{G2} = Q_\mathrm{L}
\end{aligned}
$$

We can visualize this optimization problem as the 3D surface shown in {ref}`fig_2_7`. The parallelogram shape of the surface as viewed from above in {ref}`fig_2_7`(b) is determined by the above constraint and by the bounds $0 < Q_\mathrm{G2} < 10 \ \mathrm{MWh}$.

```{figure} img/fig_2_7.png
:label: fig_2_7
:width: 100%

Determining the market-clearing quantities $Q_\mathrm{G2}$ and $Q_\mathrm{L}$ that maximize $W\!$ in Example 2.4.
```

The solution to the example at hand is $Q_\mathrm{G2}^* = 6.5 \ \mathrm{MW}$, $Q_\mathrm{L}^* = 11 \ \mathrm{MW}$, and $Q_\mathrm{G1}^* = 6 \ \mathrm{MW}$. The market-clearing prices at the two nodes are $P_{\! \mathrm{A}}^* = \$2/\mathrm{MWh}$ and $P_{\! \mathrm{B}}^* = \$5/\mathrm{MWh}$.

## Balancing power supply and demand

We previously mentioned that supply always equals demand in the electricity market. Indeed, according to the law of conservation of energy, the power flowing into the grid equals the power flowing out of the grid at any given time. However, we just said that an ISO is responsible for balancing power supply and demand in the grid. Furthermore, if you are already familiar with the power grid and electricity market, you will often hear about *balance* or *imbalance* between power supply and demand, even though an imbalance between power in and power out is not technically possible. So, what do people really mean when they talk about imbalance between supply and demand in the grid? To answer this question, we must first understand some nuances of how the grid works.

The power transferred in the grid is driven by AC voltage, which oscillates approximately 50 or 60 times a second depending on the country. This rate of oscillation is called the grid's frequency, and is measured in hertz (Hz). A lot of equipment connected to the grid requires a frequency very close to 50 or 60 Hz.

Most generators in the grid are synchronous electric generators spun by a turbine&mdash;a water turbine in a hydroelectric power station, a gas turbine in a gas power station, or a steam turbine in a nuclear or coal power station. The turbine must be fed with water, steam, or burning gas at a certain rate in order to produce a certain power output via the generator. Furthermore, a synchronous generator must be spun at a certain speed in order to generate AC voltage at the required frequency. A synchronous generator naturally rotates at a speed corresponding to the frequency of the grid to which it is connected. It will be important to know that a synchronous generator, like any moving object, inherently stores some kinetic energy while in operation, like a flywheel.

Consider the situation where one of the grid's generators has just turned off, or where more load is suddenly connected to the grid. More power must instantly be supplied to the grid such that supply continues to exactly meet demand. At first, this extra power is supplied by the grid's synchronous generators&mdash;but *not* by consuming more water, steam, or gas. Instead, the grid's synchronous generators will start slowing down at a steady rate, releasing their inherent kinetic energy and converting it to the extra power required. Synchronous generators do this immediately and naturally, due to the laws of physics rather than human intervention. This behavior of synchronous generators is called *inertial response* and applies just as well if load is suddenly disconnected from the grid, in which case the grid's synchronous generators will start speeding up to absorb the sudden surplus of power. The surplus powers the generator like a motor.

You may be wondering what happens when the generator spins down to zero. Don't bother. There would be a blackout well before that occurs. The inertial response helps to balance supply and demand, but at a cost. As the grid's generators speed up or slow down to absorb to release power as required, the grid's frequency increases or decreases. However, grid-connected equipment often requires a grid frequency within a very specific range. The inertial response only grants the ISO a few precious seconds in which to properly adjust power generation by adjusting the rate at which water, steam, or gas is consumed. If this rate cannot be increased because all the grid's generators are already operating at maximum power, then the ISO must curtail or shed load.

In the café analogy, customers are picky. The inertial response would be equivalent to baristas re-using coffee grounds to save time while serving a sudden influx of customers. Disgusting! Cafés must handle an influx of customers by paying their baristas more in order to work faster&mdash;i.e., by operating synchronous generators at a higher power setting&mdash;or by utilizing additional baristas and espresso machines&mdash;i.e., by turning on additional generators. If the cafés are already pushed to their limit, they must turn some customers away rather than continue to serve terrible-quality espresso.

So, it is appropriate (if not slightly misleading terminology) to talk about balance or imbalance between power supply and demand. What people really mean when they say that supply is not meeting electricity market demand is that the power being generated *apart from the inertial response* is not meeting demand. Discussing imbalance is the same as discussing under- or over-frequency.
